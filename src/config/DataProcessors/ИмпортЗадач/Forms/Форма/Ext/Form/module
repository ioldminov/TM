
Процедура СоздатьЗадачи(ТабличныйДокумент)
	
	КоличествоЭлементов = ТабличныйДокумент.ВысотаТаблицы - ПерваяСтрокаДанныхТабличногоДокумента + 1;
	
	ТекПорядок = офПолучитьПорядокНовойЗадачи();
	ШагПорядкаЗадач = Константы.ШагПорядкаЗадач.Получить();
	Для К = ПерваяСтрокаДанныхТабличногоДокумента По ТабличныйДокумент.ВысотаТаблицы Цикл
		Состояние("Обработано " + к + " из " + ТабличныйДокумент.ВысотаТаблицы);
		
		Суть = ТабличныйДокумент.Область("R"+Формат(К,"ЧГ=")+"C"+1).Текст;
		Описание = ТабличныйДокумент.Область("R"+Формат(К,"ЧГ=")+"C"+2).Текст;
		
		ОбъектЗадача = Документы.Задача.СоздатьДокумент();
		ОбъектЗадача.Дата = ТекущаяДата();
		ОбъектЗадача.УстановитьНовыйНомер();
		ОбъектЗадача.Порядок = ТекПорядок;
		ТекПорядок = ТекПорядок + ШагПорядкаЗадач;
		ОбъектЗадача.Автор = Автор;
		ОбъектЗадача.Исполнитель = Исполнитель;
		ОбъектЗадача.Проект = Проект;
		ОбъектЗадача.Состояние = Состояние;
		
		ОбъектЗадача.Суть = Суть;
		ОбъектЗадача.Описание = Описание;
		
		Попытка
			ОбъектЗадача.Записать();
		Исключение
		    Сообщить(ОписаниеОшибки());
		КонецПопытки;
		
	КонецЦикла;

КонецПроцедуры


Процедура КнопкаВыполнитьНажатие(Кнопка)
	
	СоздатьЗадачи(ЭлементыФормы.ПолеТабличногоДокумента);
	
КонецПроцедуры
