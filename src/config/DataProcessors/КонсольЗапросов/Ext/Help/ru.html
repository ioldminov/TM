<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"><html xmlns:o="urn:schemas-microsoft-com:office:office"><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type"></meta><link rel="stylesheet" type="text/css" href="v8help://service_book/service_style"></link><meta name="GENERATOR" content="MSHTML 8.00.6001.22902"></meta></head><body>
<p style="TEXT-ALIGN: center; MARGIN: 0cm 0cm 0pt; mso-outline-level: 1" class="MsoNormal" align="center"><u><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 14pt; mso-bidi-font-size: 10.0pt; mso-ansi-language: RU"></span></u> </p>
<p style="TEXT-ALIGN: center; MARGIN: 0cm 0cm 0pt; mso-outline-level: 1" class="MsoNormal" align="center"><u><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 14pt; mso-bidi-font-size: 10.0pt; mso-ansi-language: RU">Обработка <b style="mso-bidi-font-weight: normal">Консоль запросов</b> для управляемого приложения 1С 8.2<o:p></o:p></span></u></p>
<p style="MARGIN: 0cm 0cm 0pt" class="MsoNormal"><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU"><o:p> </o:p></span></p>
<p style="MARGIN: 0cm 0cm 0pt" class="MsoNormal"><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU">Обработка <b style="mso-bidi-font-weight: normal">Консоль запросов</b> для управляемого приложения повторяет привычный интерфейс и большинство функционала обработки Консоль запросов для 1С 8.1. Она также позволяет получать результаты <b style="mso-bidi-font-weight: normal">пакетных запросов</b> и <b style="mso-bidi-font-weight: normal">временных таблиц</b>. Нужный состав результата выполнения выбирается в поле выбора <b style="mso-bidi-font-weight: normal">Получать результаты</b> из трех вариантов: <b style="mso-bidi-font-weight: normal">Только запросов, Запросов и временных таблиц, Только временных таблиц</b>.<o:p></o:p></span></p>
<p style="MARGIN: 0cm 0cm 0pt" class="MsoNormal"><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU"><o:p> </o:p></span></p>
<p style="MARGIN: 0cm 0cm 0pt" class="MsoNormal"><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU">Запросы исполняются как под <b style="mso-bidi-font-weight: normal">толстым</b>, так и под <b style="mso-bidi-font-weight: normal">тонким клиентом</b>, поскольку для выполнения запроса по-любому происходит обращение к серверу.<o:p></o:p></span></p>
<p style="MARGIN: 0cm 0cm 0pt" class="MsoNormal"><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU"><o:p> </o:p></span></p>
<p style="MARGIN: 0cm 0cm 0pt; mso-outline-level: 1" class="MsoNormal"><b style="mso-bidi-font-weight: normal"><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU">Файл запросов<o:p></o:p></span></b></p>
<p style="MARGIN: 0cm 0cm 0pt" class="MsoNormal"><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU">Файл запросов<span style="mso-spacerun: yes">  </span>(.</span><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt" lang="EN-US">sel</span><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU">) для Консоли запросов управляемого режима аналогичен файлу для Консоли запросов платформы 8.1; можно открывать имеющиеся файлы запросов, разработанные в 8.1. Аналогично, файлы, созданные в Консоли управляемого режима, можно открывать в Консоли 8.1.<o:p></o:p></span></p>
<p style="MARGIN: 0cm 0cm 0pt" class="MsoNormal"><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU"><o:p> </o:p></span></p>
<p style="MARGIN: 0cm 0cm 0pt; mso-outline-level: 1" class="MsoNormal"><b style="mso-bidi-font-weight: normal"><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU">Конструктор запроса</span></b><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU"><o:p></o:p></span></p>
<p style="MARGIN: 0cm 0cm 0pt" class="MsoNormal"><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU">Конструктор запроса вызывается через контекстное меню поля текста запроса. Конструктор запроса в тонком клиенте недоступен - пункт меню открытия Конструктора блокируется. В толстом клиенте управляемого приложения Конструктор запроса доступен..<o:p></o:p></span></p>
<p style="MARGIN: 0cm 0cm 0pt" class="MsoNormal"><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU"><o:p> </o:p></span></p>
<p style="MARGIN: 0cm 0cm 0pt; mso-outline-level: 1" class="MsoNormal"><b style="mso-bidi-font-weight: normal"><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU">Цветовое оформление</span></b><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU"><o:p></o:p></span></p>
<p style="MARGIN: 0cm 0cm 0pt" class="MsoNormal"><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU">Управляемое приложение не поддерживает подсветку ключевых слов текста запроса, поэтому весь текст запроса отображается черным цветом.<o:p></o:p></span></p>
<p style="MARGIN: 0cm 0cm 0pt" class="MsoNormal"><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU"><o:p> </o:p></span></p>
<p style="MARGIN: 0cm 0cm 0pt; mso-outline-level: 1" class="MsoNormal"><b style="mso-bidi-font-weight: normal"><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU">Параметры запроса</span></b><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU"><o:p></o:p></span></p>
<p style="MARGIN: 0cm 0cm 0pt" class="MsoNormal"><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU">Параметры текущего запроса вводятся на закладке <b style="mso-bidi-font-weight: normal">Параметры запроса</b> в левой верхней части формы Консоли, на внутренней закладке <b style="mso-bidi-font-weight: normal">Общие</b>. По кнопке <b style="mso-bidi-font-weight: normal">Заполнить</b> производится автоматическое заполнение списка параметров из текста запроса.<o:p></o:p></span></p>
<p style="MARGIN: 0cm 0cm 0pt" class="MsoNormal"><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU">Можно задавать параметр типа <b style="mso-bidi-font-weight: normal">Тип</b>. Для этого нужно назначить тип параметра <b style="mso-bidi-font-weight: normal">ОписаниеТипов</b> и задать требуемый тип. Если будет задан составной тип, то будет использоваться только первое значение из состава типов.<o:p></o:p></span></p>
<p style="MARGIN: 0cm 0cm 0pt" class="MsoNormal"><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt" lang="EN-US"><o:p> </o:p></span></p>
<p style="MARGIN: 0cm 0cm 0pt" class="MsoNormal"><b style="mso-bidi-font-weight: normal"><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU">Параметры запроса типа </span></b><i style="mso-bidi-font-style: normal"><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU">Граница</span></i><b style="mso-bidi-font-weight: normal"><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU"> и </span></b><i style="mso-bidi-font-style: normal"><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU">МоментВремени<o:p></o:p></span></i></p>
<p style="MARGIN: 0cm 0cm 0pt" class="MsoNormal"><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU">Параметры запроса этих типов редактируются на внутренней закладке <b style="mso-bidi-font-weight: normal">Особые</b> закладки <b style="mso-bidi-font-weight: normal">Параметры запроса</b> (она имеет специальный цветовой стиль). Их можно вводить вручную по кнопке <b style="mso-bidi-font-weight: normal">Добавить</b>, а также переводить в категорию "особых" параметры с внутренней закладки <b style="mso-bidi-font-weight: normal">Общие</b>, выполнив щелчок по флажку в колонке <b style="mso-bidi-font-weight: normal">Особый тип</b> - при щелчке по флажку выдается предупреждающее сообщение, и при положительном ответе на него параметр будет переведен на закладку <b style="mso-bidi-font-weight: normal">Особые</b>. (При автозаполнении списка параметров по кнопке <b style="mso-bidi-font-weight: normal">Заполнить</b> все параметры попадают на закладку <b style="mso-bidi-font-weight: normal">Общие</b>).<o:p></o:p></span></p>
<p style="MARGIN: 0cm 0cm 0pt" class="MsoNormal"><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU">Для редактирования параметров этих типов открывается специальная форма <b style="mso-bidi-font-weight: normal">Редактирование параметра особого типа</b>, в которой есть поля для редактирования имени параметра и указания типа параметра (пока доступны типы <b style="mso-bidi-font-weight: normal">Граница</b> и <b style="mso-bidi-font-weight: normal">МоментВремени</b>; в дальнейшем предполагается добавить тип <b style="mso-bidi-font-weight: normal">ТаблицаЗначений</b>). При выборе типа из списка <b style="mso-bidi-font-weight: normal">Тип параметра</b> на форме появляются поля для задания значения параметра выбранного типа. Для задания значения параметра типа <b style="mso-bidi-font-weight: normal">МоментВремени</b> нужно указать документ, а для задания параметра типа <b style="mso-bidi-font-weight: normal">Граница</b> нужно указать значение и тип границы (<b style="mso-bidi-font-weight: normal">Включая</b> или <b style="mso-bidi-font-weight: normal">Исключая</b>). Для задания значения границы можно указать дату либо момент времени (выбирается при помощи радиокнопки <b style="mso-bidi-font-weight: normal">Способ задания</b>; в случае задания способа <b style="mso-bidi-font-weight: normal">Дата</b> нужно задать дату, а в случае задания способа <b style="mso-bidi-font-weight: normal">Момент времени</b> нужно задать документ).<o:p></o:p></span></p>
<p style="MARGIN: 0cm 0cm 0pt" class="MsoNormal"><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU">Редактирование параметра завершается нажатием кнопки <b style="mso-bidi-font-weight: normal">Завершить</b>.<o:p></o:p></span></p>
<p style="MARGIN: 0cm 0cm 0pt" class="MsoNormal"><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU"><o:p> </o:p></span></p>
<p style="MARGIN: 0cm 0cm 0pt" class="MsoNormal"><b style="mso-bidi-font-weight: normal"><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU">Поле результата запроса</span></b><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU"><o:p></o:p></span></p>
<p style="MARGIN: 0cm 0cm 0pt" class="MsoNormal"><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU">Для отображения результата запроса в управляемом режиме используется поле табличного документа. Поскольку автоматически выровнять ширину таблицы результата по правому краю поля затруднительно, применяется визуальное выравнивание при помощи полосы регулирования (слайдера) <b style="mso-bidi-font-weight: normal">Ширина колонок</b> внизу формы: при перемещении ползунка вправо или влево меняется ширина сразу всех колонок таблицы результата, таким образом, можно подогнать правую границу таблицы результата под правый край формы. Ширина колонок каждого запроса сохраняется в файле запросов (.</span><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt" lang="EN-US">sel</span><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU">). <o:p></o:p></span></p>
<p style="MARGIN: 0cm 0cm 0pt" class="MsoNormal"><i style="mso-bidi-font-style: normal"><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU">Примечание</span></i><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU">. Если файл запросов последний раз редактировался в Консоли запросов 8.1, то при открытии его в Консоли управляемого приложения ширина колонки результата для всех запросов устанавливается в значение по умолчанию, так как Консоль запросов 8.1 это значение не сохраняет.<o:p></o:p></span></p>
<p style="MARGIN: 0cm 0cm 0pt" class="MsoNormal"><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU"><o:p> </o:p></span></p>
<p style="MARGIN: 0cm 0cm 0pt; mso-outline-level: 1" class="MsoNormal"><b style="mso-bidi-font-weight: normal"><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU">Вложенные таблицы</span></b><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU"><o:p></o:p></span></p>
<p style="MARGIN: 0cm 0cm 0pt" class="MsoNormal"><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU">Вложенные таблицы (когда поле результата запроса само имеет тип РезультатЗапроса) отображаются зеленой надписью &lt;РЕЗУЛЬТАТ ЗАПРОСА&gt; в ячейке поля результата. Вложенная таблица открывается двойным щелчком в виде табличного документа.<o:p></o:p></span></p>
<p style="MARGIN: 0cm 0cm 0pt" class="MsoNormal"><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU"><o:p> </o:p></span></p>
<p style="MARGIN: 0cm 0cm 0pt; mso-outline-level: 1" class="MsoNormal"><b style="mso-bidi-font-weight: normal"><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU">Пакетные запросы<o:p></o:p></span></b></p>
<p style="MARGIN: 0cm 0cm 0pt" class="MsoNormal"><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU">Поименованные результаты пакетных запросов выводятся в поле результата один под другим. Способ выгрузки и ширина колонок одинаковы для результатов всех запросов пакета. <o:p></o:p></span></p>
<p style="MARGIN: 0cm 0cm 0pt" class="MsoNormal"><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU"><o:p> </o:p></span></p>
<p style="MARGIN: 0cm 0cm 0pt; mso-outline-level: 1" class="MsoNormal"><b style="mso-bidi-font-weight: normal"><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU">Временные таблицы<o:p></o:p></span></b></p>
<p style="MARGIN: 0cm 0cm 0pt" class="MsoNormal"><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU">Если выбрано получение временных таблиц, то после выполнения запроса в тексте запросов ищутся все имена временных таблиц, и для каждой поочередно выполняется выборка, результат которой выводится. Если в пакетном запросе имеются предложения УНИЧТОЖИТЬ,<span style="mso-spacerun: yes">  </span>то для уничтоженных таблиц выводится сообщение об ошибке.<o:p></o:p></span></p>
<p style="MARGIN: 0cm 0cm 0pt" class="MsoNormal"><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU"><o:p> </o:p></span></p>
<p style="MARGIN: 0cm 0cm 0pt; mso-outline-level: 1" class="MsoNormal"><b style="mso-bidi-font-weight: normal"><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU">Выполнение выделенного текста<o:p></o:p></span></b></p>
<p style="MARGIN: 0cm 0cm 0pt" class="MsoNormal"><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU">Если выделить фрагмент текста в поле текста запроса, то, выбрав пункт контекстного меню <b style="mso-bidi-font-weight: normal">Выполнить выделенный текст</b>, можно выполнить выделенный фрагмент как самостоятельный запрос. Это позволяет выполнять отдельные запросы пакета и вложенные запросы. Конечно, нужно следить, чтобы выделенный текст представлял синтаксически правильный запрос.<o:p></o:p></span></p>
<p style="MARGIN: 0cm 0cm 0pt" class="MsoNormal"><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU"><o:p> </o:p></span></p>
<p style="MARGIN: 0cm 0cm 0pt; mso-outline-level: 1" class="MsoNormal"><b style="mso-bidi-font-weight: normal"><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU">Переподчинение запроса в дереве запросов<o:p></o:p></span></b></p>
<p style="MARGIN: 0cm 0cm 0pt" class="MsoNormal"><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU">Для переноса запроса в другую ветвь дерева нужно выполнить перетаскивание мышью этого запроса на новую родительскую ветвь. Производится контроль возможности зацикливания подчинения, в этом случае выдается предупреждение и переподчинение не выполняется.<o:p></o:p></span></p>
<p style="MARGIN: 0cm 0cm 0pt" class="MsoNormal"><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU"><o:p> </o:p></span></p>
<div style="BORDER-BOTTOM: windowtext 1.5pt solid; BORDER-LEFT: medium none; PADDING-BOTTOM: 1pt; PADDING-LEFT: 0cm; PADDING-RIGHT: 0cm; BORDER-TOP: medium none; BORDER-RIGHT: medium none; PADDING-TOP: 0cm; mso-element: para-border-div">
<p style="BORDER-BOTTOM: medium none; BORDER-LEFT: medium none; PADDING-BOTTOM: 0cm; MARGIN: 0cm 0cm 0pt; PADDING-LEFT: 0cm; PADDING-RIGHT: 0cm; BORDER-TOP: medium none; BORDER-RIGHT: medium none; PADDING-TOP: 0cm; mso-border-bottom-alt: solid windowtext 1.5pt; mso-padding-alt: 0cm 0cm 1.0pt 0cm" class="MsoNormal"><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU"><o:p> </o:p></span></p></div>
<p style="MARGIN: 0cm 0cm 0pt" class="MsoNormal"><span style="FONT-FAMILY: 'Arial','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU"><o:p><span style="FONT-FAMILY: 'Arial CYR','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU">©<i style="mso-bidi-font-style: normal">Николай Больсунов,<o:p></o:p></i></span></o:p></span></p>
<p style="MARGIN: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><i style="mso-bidi-font-style: normal"><span style="FONT-FAMILY: 'Arial CYR','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU">январь 2010г. - май 2012г.<o:p></o:p></span></i></p>
<p style="MARGIN: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="FONT-FAMILY: 'Arial CYR','sans-serif'; FONT-SIZE: 10pt; mso-ansi-language: RU"><a href="mailto:occam@mail.ru"><font face="Times New Roman"><span style="mso-ansi-language: EN-US; mso-bidi-font-family: 'Arial CYR'" lang="EN-US">occam</span><span style="mso-bidi-font-family: 'Arial CYR'">@</span><span style="mso-ansi-language: EN-US; mso-bidi-font-family: 'Arial CYR'" lang="EN-US">mail</span><span style="mso-bidi-font-family: 'Arial CYR'">.</span><span style="mso-ansi-language: EN-US; mso-bidi-font-family: 'Arial CYR'" lang="EN-US">ru</span></font></a><o:p></o:p></span></p>
<p style="MARGIN: 0cm 0cm 0pt; mso-layout-grid-align: none" class="MsoNormal"><span style="FONT-FAMILY: 'MS Shell Dlg','sans-serif'; FONT-SIZE: 8.5pt; mso-ansi-language: RU"><o:p> </o:p></span></p>
<p style="MARGIN: 0cm 0cm 0pt" class="MsoNormal"></p></body></html>